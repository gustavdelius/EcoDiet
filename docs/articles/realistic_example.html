<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2. EcoDiet explored on a realistic example â€¢ EcoDiet</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="2. EcoDiet explored on a realistic example">
<meta property="og:description" content="EcoDiet">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EcoDiet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction_EcoDiet.html">1. Introduction - How to use EcoDiet</a>
    </li>
    <li>
      <a href="../articles/realistic_example.html">2. EcoDiet explored on a realistic example</a>
    </li>
    <li>
      <a href="../articles/convergence_problems.html">3. How to deal with convergence problems</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pyhernvann/EcoDiet/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>2. EcoDiet explored on a realistic example</h1>
                        <h4 data-toc-skip class="author">Heloise Thero,
Pierre-Yves Hernvann</h4>
            
            <h4 data-toc-skip class="date">2024-07-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pyhernvann/EcoDiet/blob/HEAD/vignettes/realistic_example.Rmd" class="external-link"><code>vignettes/realistic_example.Rmd</code></a></small>
      <div class="hidden name"><code>realistic_example.Rmd</code></div>

    </div>

    
    
<p>The introduction employed a simplistic example of food web to
familiarize the user with the basic commands and options of the EcoDiet
package. Here we will use a more realistic example (although still
artificial!) to run the different EcoDiet configurations, compare their
results and hence highlight the complementarity in the different data
used.</p>
<p>The data corresponds to 10 trophic groups with stomach content data,
and very distinct isotopic measures.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">realistic_stomach_data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"realistic_stomach_data.csv"</span>,</span>
<span>                                           package <span class="op">=</span> <span class="st">"EcoDiet"</span><span class="op">)</span></span>
<span><span class="va">realistic_stomach_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">realistic_stomach_data_path</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">realistic_stomach_data</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="14%">
<col width="4%">
<col width="5%">
<col width="8%">
<col width="8%">
<col width="6%">
<col width="9%">
<col width="6%">
<col width="12%">
<col width="14%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left">X</th>
<th align="right">Cod</th>
<th align="right">Pout</th>
<th align="right">Sardine</th>
<th align="right">Shrimps</th>
<th align="right">Crabs</th>
<th align="right">Bivalves</th>
<th align="right">Worms</th>
<th align="right">Zooplankton</th>
<th align="right">Phytoplankton</th>
<th align="right">Detritus</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Cod</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Pout</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Sardine</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Shrimps</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">29</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Crabs</td>
<td align="right">1</td>
<td align="right">24</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Bivalves</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Worms</td>
<td align="right">16</td>
<td align="right">30</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">24</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Zooplankton</td>
<td align="right">0</td>
<td align="right">27</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Phytoplankton</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">14</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">16</td>
<td align="right">0</td>
<td align="right">20</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Detritus</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">12</td>
<td align="right">19</td>
<td align="right">18</td>
<td align="right">18</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">full</td>
<td align="right">21</td>
<td align="right">30</td>
<td align="right">29</td>
<td align="right">19</td>
<td align="right">29</td>
<td align="right">27</td>
<td align="right">18</td>
<td align="right">20</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">realistic_biotracer_data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"realistic_biotracer_data.csv"</span>,</span>
<span>                                           package <span class="op">=</span> <span class="st">"EcoDiet"</span><span class="op">)</span></span>
<span><span class="va">realistic_biotracer_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">realistic_biotracer_data_path</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">realistic_biotracer_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">31</span><span class="op">:</span><span class="fl">33</span>, <span class="fl">61</span><span class="op">:</span><span class="fl">63</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">group</th>
<th align="right">d13C</th>
<th align="right">d15N</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Cod</td>
<td align="right">-12.94144</td>
<td align="right">19.18913</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">Cod</td>
<td align="right">-14.96070</td>
<td align="right">20.23939</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">Cod</td>
<td align="right">-13.77822</td>
<td align="right">19.48809</td>
</tr>
<tr class="even">
<td align="left">31</td>
<td align="left">Pout</td>
<td align="right">-13.47127</td>
<td align="right">18.57353</td>
</tr>
<tr class="odd">
<td align="left">32</td>
<td align="left">Pout</td>
<td align="right">-13.16888</td>
<td align="right">17.58714</td>
</tr>
<tr class="even">
<td align="left">33</td>
<td align="left">Pout</td>
<td align="right">-14.23085</td>
<td align="right">17.38938</td>
</tr>
<tr class="odd">
<td align="left">61</td>
<td align="left">Sardine</td>
<td align="right">-14.56111</td>
<td align="right">16.95231</td>
</tr>
<tr class="even">
<td align="left">62</td>
<td align="left">Sardine</td>
<td align="right">-15.04729</td>
<td align="right">17.15197</td>
</tr>
<tr class="odd">
<td align="left">63</td>
<td align="left">Sardine</td>
<td align="right">-14.63688</td>
<td align="right">16.90906</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pyhernvann/EcoDiet" class="external-link">EcoDiet</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_data.html">plot_data</a></span><span class="op">(</span>biotracer_data <span class="op">=</span> <span class="va">realistic_biotracer_data</span>,</span>
<span>          stomach_data <span class="op">=</span> <span class="va">realistic_stomach_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="realistic_example_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<pre><code><span><span class="co">#&gt; Warning: Use of `biotracer_data$group` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Use `group` instead.</span></span></code></pre>
<p><img src="realistic_example_files/figure-html/unnamed-chunk-4-2.png" width="768"></p>
<p>Yes, we are aware that isotopic data is usually messier, but isnâ€™t it
a beautiful plot?</p>
<div class="section level2">
<h2 id="the-configuration-without-literature-data">The configuration without literature data<a class="anchor" aria-label="anchor" href="#the-configuration-without-literature-data"></a>
</h2>
<p>We define the configuration we are in, and preprocess the data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">literature_configuration</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span><span class="op">(</span>biotracer_data <span class="op">=</span> <span class="va">realistic_biotracer_data</span>,</span>
<span>                        trophic_discrimination_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>                        literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span>,</span>
<span>                        stomach_data <span class="op">=</span> <span class="va">realistic_stomach_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; The model will investigate the following trophic links:</span></span>
<span><span class="co">#&gt;               Bivalves Cod Crabs Detritus Phytoplankton Pout Sardine Shrimps</span></span>
<span><span class="co">#&gt; Bivalves             0   0     1        0             0    1       0       0</span></span>
<span><span class="co">#&gt; Cod                  0   0     0        0             0    0       0       0</span></span>
<span><span class="co">#&gt; Crabs                0   1     0        0             0    1       0       0</span></span>
<span><span class="co">#&gt; Detritus             1   0     1        0             0    0       0       1</span></span>
<span><span class="co">#&gt; Phytoplankton        1   0     0        0             0    0       1       1</span></span>
<span><span class="co">#&gt; Pout                 0   1     0        0             0    0       0       0</span></span>
<span><span class="co">#&gt; Sardine              0   1     0        0             0    0       0       0</span></span>
<span><span class="co">#&gt; Shrimps              0   1     1        0             0    1       1       0</span></span>
<span><span class="co">#&gt; Worms                0   1     1        0             0    1       0       1</span></span>
<span><span class="co">#&gt; Zooplankton          0   0     0        0             0    1       1       1</span></span>
<span><span class="co">#&gt;               Worms Zooplankton</span></span>
<span><span class="co">#&gt; Bivalves          0           0</span></span>
<span><span class="co">#&gt; Cod               0           0</span></span>
<span><span class="co">#&gt; Crabs             0           0</span></span>
<span><span class="co">#&gt; Detritus          1           0</span></span>
<span><span class="co">#&gt; Phytoplankton     0           1</span></span>
<span><span class="co">#&gt; Pout              0           0</span></span>
<span><span class="co">#&gt; Sardine           0           0</span></span>
<span><span class="co">#&gt; Shrimps           0           0</span></span>
<span><span class="co">#&gt; Worms             0           0</span></span>
<span><span class="co">#&gt; Zooplankton       0           0</span></span></code></pre></div>
<p>In this configuration, priors are set for each trophic link
identified as plausible by the user but the priors are not informed by
literature data, and are thus uninformative:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prior.html">plot_prior</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">literature_configuration</span><span class="op">)</span></span></code></pre></div>
<p><img src="realistic_example_files/figure-html/unnamed-chunk-6-1.png" width="768"><img src="realistic_example_files/figure-html/unnamed-chunk-6-2.png" width="768"></p>
<p>The marginal prior distributions have different shape depending on
the variables:</p>
<ul>
<li><p>it is flat or uniform for <span class="math inline">\(\eta\)</span>, the probabilities that a trophic
link exists (all the probabilities of existence are thus
equiprobable),</p></li>
<li><p>the marginal distributions for each diet proportion <span class="math inline">\(\Pi\)</span> are peaking at zero, although the
joint distribution for <span class="math inline">\(\Pi\)</span>s is a
flat Dirichlet prior, because all the diet proportions must sum to
one.</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prior.html">plot_prior</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">literature_configuration</span>, pred <span class="op">=</span> <span class="st">"Pout"</span><span class="op">)</span></span></code></pre></div>
<p><img src="realistic_example_files/figure-html/unnamed-chunk-7-1.png" width="768"><img src="realistic_example_files/figure-html/unnamed-chunk-7-2.png" width="768"></p>
<p>We define the model, and test if it compiles well with a few
iterations and adaptation steps:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="st">"mymodel.txt"</span></span>
<span><span class="fu"><a href="../reference/write_model.html">write_model</a></span><span class="op">(</span>file.name <span class="op">=</span> <span class="va">filename</span>, literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span>, print.model <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">mcmc_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span><span class="va">filename</span>, <span class="va">data</span>, run_param<span class="op">=</span><span class="st">"test"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Processing function input....... </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Done. </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Compiling model graph</span></span>
<span><span class="co">#&gt;    Resolving undeclared variables</span></span>
<span><span class="co">#&gt;    Allocating nodes</span></span>
<span><span class="co">#&gt; Graph information:</span></span>
<span><span class="co">#&gt;    Observed stochastic nodes: 316</span></span>
<span><span class="co">#&gt;    Unobserved stochastic nodes: 125</span></span>
<span><span class="co">#&gt;    Total graph size: 1104</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initializing model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adaptive phase, 500 iterations x 3 chains </span></span>
<span><span class="co">#&gt; If no progress bar appears JAGS has decided not to adapt </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Burn-in phase, 500 iterations x 3 chains </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sampling from joint posterior, 500 iterations x 3 chains </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculating statistics....... </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   /!\ Convergence warning:</span></span>
<span><span class="co">#&gt; Out of the 51 variables, 14 variables have a Gelman-Rubin statistic &gt; 1.1.</span></span>
<span><span class="co">#&gt; You may consider modifying the model run settings.</span></span>
<span><span class="co">#&gt; The variables with the poorest convergence are: PI[4,3], PI[10,8], PI[10,7], PI[8,6], PI[8,2], PI[6,2], PI[7,2], PI[9,8], PI[9,3], PI[8,7].</span></span>
<span><span class="co">#&gt; JAGS output for model 'mymodel.txt', generated by jagsUI.</span></span>
<span><span class="co">#&gt; Estimates based on 3 chains of 1000 iterations,</span></span>
<span><span class="co">#&gt; adaptation = 500 iterations (sufficient),</span></span>
<span><span class="co">#&gt; burn-in = 500 iterations and thin rate = 1,</span></span>
<span><span class="co">#&gt; yielding 1500 total samples from the joint posterior. </span></span>
<span><span class="co">#&gt; MCMC ran for 0.235 minutes at time 2024-07-10 10:08:16.119673.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              mean     sd    2.5%     50%   97.5% overlap0 f  Rhat n.eff</span></span>
<span><span class="co">#&gt; eta[4,1]    0.648  0.084   0.481   0.648   0.800    FALSE 1 1.002   649</span></span>
<span><span class="co">#&gt; eta[5,1]    0.592  0.086   0.419   0.593   0.756    FALSE 1 1.001  1500</span></span>
<span><span class="co">#&gt; eta[3,2]    0.091  0.059   0.012   0.080   0.233    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[6,2]    0.088  0.059   0.012   0.076   0.240    FALSE 1 1.011   200</span></span>
<span><span class="co">#&gt; eta[7,2]    0.425  0.101   0.233   0.425   0.624    FALSE 1 1.002   877</span></span>
<span><span class="co">#&gt; eta[8,2]    0.220  0.085   0.082   0.213   0.403    FALSE 1 1.013   153</span></span>
<span><span class="co">#&gt; eta[9,2]    0.734  0.092   0.536   0.742   0.888    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[1,3]    0.389  0.087   0.225   0.384   0.565    FALSE 1 1.005   449</span></span>
<span><span class="co">#&gt; eta[4,3]    0.639  0.085   0.467   0.641   0.801    FALSE 1 1.019   107</span></span>
<span><span class="co">#&gt; eta[8,3]    0.808  0.069   0.664   0.813   0.924    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[9,3]    0.811  0.069   0.657   0.819   0.927    FALSE 1 0.999  1500</span></span>
<span><span class="co">#&gt; eta[1,6]    0.126  0.058   0.036   0.119   0.257    FALSE 1 1.011   241</span></span>
<span><span class="co">#&gt; eta[3,6]    0.788  0.070   0.638   0.793   0.908    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[8,6]    0.156  0.062   0.054   0.151   0.293    FALSE 1 1.005   404</span></span>
<span><span class="co">#&gt; eta[9,6]    0.969  0.029   0.893   0.978   0.999    FALSE 1 1.002  1385</span></span>
<span><span class="co">#&gt; eta[10,6]   0.876  0.056   0.751   0.884   0.963    FALSE 1 1.001  1500</span></span>
<span><span class="co">#&gt; eta[5,7]    0.491  0.087   0.335   0.487   0.667    FALSE 1 1.001  1161</span></span>
<span><span class="co">#&gt; eta[8,7]    0.970  0.029   0.893   0.979   0.999    FALSE 1 1.001  1500</span></span>
<span><span class="co">#&gt; eta[10,7]   0.225  0.076   0.096   0.220   0.379    FALSE 1 1.007   289</span></span>
<span><span class="co">#&gt; eta[4,8]    0.608  0.108   0.393   0.611   0.810    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[5,8]    0.525  0.107   0.314   0.525   0.726    FALSE 1 1.003   540</span></span>
<span><span class="co">#&gt; eta[9,8]    0.100  0.065   0.014   0.089   0.251    FALSE 1 1.002   666</span></span>
<span><span class="co">#&gt; eta[10,8]   0.194  0.083   0.062   0.183   0.370    FALSE 1 1.005   384</span></span>
<span><span class="co">#&gt; eta[4,9]    0.948  0.050   0.815   0.964   0.998    FALSE 1 1.001  1034</span></span>
<span><span class="co">#&gt; eta[5,10]   0.953  0.045   0.836   0.967   0.999    FALSE 1 1.005   516</span></span>
<span><span class="co">#&gt; PI[4,1]     0.394  0.286   0.000   0.361   0.966    FALSE 1 1.014   138</span></span>
<span><span class="co">#&gt; PI[5,1]     0.606  0.286   0.034   0.639   1.000    FALSE 1 1.014   138</span></span>
<span><span class="co">#&gt; PI[3,2]     0.217  0.296   0.000   0.053   0.951    FALSE 1 1.059    60</span></span>
<span><span class="co">#&gt; PI[6,2]     0.167  0.231   0.000   0.024   0.766    FALSE 1 1.460     8</span></span>
<span><span class="co">#&gt; PI[7,2]     0.122  0.210   0.000   0.000   0.718    FALSE 1 1.364    11</span></span>
<span><span class="co">#&gt; PI[8,2]     0.284  0.335   0.000   0.124   0.998    FALSE 1 1.489     8</span></span>
<span><span class="co">#&gt; PI[9,2]     0.209  0.204   0.000   0.152   0.770    FALSE 1 1.032   281</span></span>
<span><span class="co">#&gt; PI[1,3]     0.163  0.232   0.000   0.040   0.795    FALSE 1 1.208    17</span></span>
<span><span class="co">#&gt; PI[4,3]     0.163  0.202   0.000   0.000   0.583    FALSE 1 2.878     4</span></span>
<span><span class="co">#&gt; PI[8,3]     0.277  0.210   0.000   0.253   0.719    FALSE 1 1.050    66</span></span>
<span><span class="co">#&gt; PI[9,3]     0.397  0.305   0.002   0.330   0.997    FALSE 1 1.291    11</span></span>
<span><span class="co">#&gt; PI[1,6]     0.069  0.133   0.000   0.001   0.493    FALSE 1 1.239    15</span></span>
<span><span class="co">#&gt; PI[3,6]     0.320  0.193   0.011   0.304   0.741    FALSE 1 1.069    36</span></span>
<span><span class="co">#&gt; PI[8,6]     0.051  0.120   0.000   0.001   0.467    FALSE 1 1.520    10</span></span>
<span><span class="co">#&gt; PI[9,6]     0.291  0.200   0.011   0.258   0.732    FALSE 1 1.003  1429</span></span>
<span><span class="co">#&gt; PI[10,6]    0.269  0.192   0.005   0.239   0.708    FALSE 1 1.033    75</span></span>
<span><span class="co">#&gt; PI[5,7]     0.328  0.180   0.000   0.340   0.653    FALSE 1 1.147    24</span></span>
<span><span class="co">#&gt; PI[8,7]     0.578  0.196   0.101   0.602   0.905    FALSE 1 1.279    13</span></span>
<span><span class="co">#&gt; PI[10,7]    0.094  0.234   0.000   0.000   0.882    FALSE 1 1.705     7</span></span>
<span><span class="co">#&gt; PI[4,8]     0.213  0.206   0.000   0.159   0.728    FALSE 1 1.021   143</span></span>
<span><span class="co">#&gt; PI[5,8]     0.301  0.216   0.001   0.283   0.777    FALSE 1 1.185    15</span></span>
<span><span class="co">#&gt; PI[9,8]     0.219  0.191   0.000   0.162   0.642    FALSE 1 1.331    10</span></span>
<span><span class="co">#&gt; PI[10,8]    0.266  0.271   0.000   0.169   0.857    FALSE 1 1.770     6</span></span>
<span><span class="co">#&gt; PI[4,9]     1.000  0.000   1.000   1.000   1.000    FALSE 1    NA     1</span></span>
<span><span class="co">#&gt; PI[5,10]    1.000  0.000   1.000   1.000   1.000    FALSE 1    NA     1</span></span>
<span><span class="co">#&gt; deviance  866.400 11.003 846.223 865.943 887.645    FALSE 1 1.019   106</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; **WARNING** Some Rhat values could not be calculated.</span></span>
<span><span class="co">#&gt; **WARNING** Rhat values indicate convergence failure. </span></span>
<span><span class="co">#&gt; Rhat is the potential scale reduction factor (at convergence, Rhat=1). </span></span>
<span><span class="co">#&gt; For each parameter, n.eff is a crude measure of effective sample size. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; overlap0 checks if 0 falls in the parameter's 95% credible interval.</span></span>
<span><span class="co">#&gt; f is the proportion of the posterior with the same sign as the mean;</span></span>
<span><span class="co">#&gt; i.e., our confidence that the parameter is positive or negative.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; DIC info: (pD = var(deviance)/2) </span></span>
<span><span class="co">#&gt; pD = 59.5 and DIC = 925.854 </span></span>
<span><span class="co">#&gt; DIC is an estimate of expected predictive error (lower is better).</span></span></code></pre></div>
<p>You should now try to run the model until it converges (it should
take around <strong>half an hour</strong> to run, so we wonâ€™t do it in
this vignette):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span><span class="va">filename</span>, <span class="va">data</span>, run_param<span class="op">=</span><span class="st">"normal"</span>, parallelize <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>Here are the figures corresponding to the results that have
converged:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_results.html">plot_results</a></span><span class="op">(</span><span class="va">mcmc_output</span>, <span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/eta_mean_without_lit.png" width="700"></p>
<p><img src="../reference/figures/PI_mean_without_lit.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_results.html">plot_results</a></span><span class="op">(</span><span class="va">mcmc_output</span>, <span class="va">data</span>, pred <span class="op">=</span> <span class="st">"Pout"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/eta_pouts_without_lit.png" width="550"></p>
<p><img src="../reference/figures/PI_pouts_without_lit.png" width="550"></p>
<p>You can also plot the results for specific prey if you want a clearer
figure:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_results.html">plot_results</a></span><span class="op">(</span><span class="va">mcmc_output</span>, <span class="va">data</span>, pred <span class="op">=</span> <span class="st">"Pout"</span>, </span>
<span>             variable <span class="op">=</span> <span class="st">"PI"</span>, prey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bivalves"</span>, <span class="st">"Worms"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/PI_pouts_without_lit_details.png" width="550"></p>
</div>
<div class="section level2">
<h2 id="the-configuration-with-literature-data">The configuration with literature data<a class="anchor" aria-label="anchor" href="#the-configuration-with-literature-data"></a>
</h2>
<p>We now change the configuration to add literature data to the
model:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">literature_configuration</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">realistic_literature_diets_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"realistic_literature_diets.csv"</span>,</span>
<span>                                               package <span class="op">=</span> <span class="st">"EcoDiet"</span><span class="op">)</span></span>
<span><span class="va">realistic_literature_diets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">realistic_literature_diets_path</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">realistic_literature_diets</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="12%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="5%">
<col width="10%">
<col width="12%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left">X</th>
<th align="right">Cod</th>
<th align="right">Pout</th>
<th align="right">Sardine</th>
<th align="right">Shrimps</th>
<th align="right">Crabs</th>
<th align="right">Bivalves</th>
<th align="right">Worms</th>
<th align="right">Zooplankton</th>
<th align="right">Phytoplankton</th>
<th align="right">Detritus</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Cod</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Pout</td>
<td align="right">0.4275065</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Sardine</td>
<td align="right">0.3603675</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Shrimps</td>
<td align="right">0.0300737</td>
<td align="right">0.5295859</td>
<td align="right">0.0002143</td>
<td align="right">0.0000000</td>
<td align="right">0.0082107</td>
<td align="right">0.0000000</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Crabs</td>
<td align="right">0.1410430</td>
<td align="right">0.3332779</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Bivalves</td>
<td align="right">0.0000000</td>
<td align="right">0.0006130</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.3441081</td>
<td align="right">0.0000000</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Worms</td>
<td align="right">0.0410093</td>
<td align="right">0.1023676</td>
<td align="right">0.0000000</td>
<td align="right">0.0171336</td>
<td align="right">0.4435377</td>
<td align="right">0.0000000</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Zooplankton</td>
<td align="right">0.0000000</td>
<td align="right">0.0341557</td>
<td align="right">0.7381375</td>
<td align="right">0.9121505</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Phytoplankton</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.2616482</td>
<td align="right">0.0000610</td>
<td align="right">0.0000000</td>
<td align="right">0.9966847</td>
<td align="right">0.0</td>
<td align="right">1.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Detritus</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0706550</td>
<td align="right">0.2041434</td>
<td align="right">0.0033153</td>
<td align="right">1.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">pedigree</td>
<td align="right">0.8000000</td>
<td align="right">0.1000000</td>
<td align="right">0.5000000</td>
<td align="right">0.3000000</td>
<td align="right">0.7000000</td>
<td align="right">0.1000000</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span><span class="op">(</span>biotracer_data <span class="op">=</span> <span class="va">realistic_biotracer_data</span>,</span>
<span>                        trophic_discrimination_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>                        literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span>,</span>
<span>                        stomach_data <span class="op">=</span> <span class="va">realistic_stomach_data</span>,</span>
<span>                        literature_diets <span class="op">=</span> <span class="va">realistic_literature_diets</span>,</span>
<span>                        nb_literature <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                        literature_slope <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; The model will investigate the following trophic links:</span></span>
<span><span class="co">#&gt;               Bivalves Cod Crabs Detritus Phytoplankton Pout Sardine Shrimps</span></span>
<span><span class="co">#&gt; Bivalves             0   0     1        0             0    1       0       0</span></span>
<span><span class="co">#&gt; Cod                  0   0     0        0             0    0       0       0</span></span>
<span><span class="co">#&gt; Crabs                0   1     0        0             0    1       0       0</span></span>
<span><span class="co">#&gt; Detritus             1   0     1        0             0    0       0       1</span></span>
<span><span class="co">#&gt; Phytoplankton        1   0     0        0             0    0       1       1</span></span>
<span><span class="co">#&gt; Pout                 0   1     0        0             0    0       0       0</span></span>
<span><span class="co">#&gt; Sardine              0   1     0        0             0    0       0       0</span></span>
<span><span class="co">#&gt; Shrimps              0   1     1        0             0    1       1       0</span></span>
<span><span class="co">#&gt; Worms                0   1     1        0             0    1       0       1</span></span>
<span><span class="co">#&gt; Zooplankton          0   0     0        0             0    1       1       1</span></span>
<span><span class="co">#&gt;               Worms Zooplankton</span></span>
<span><span class="co">#&gt; Bivalves          0           0</span></span>
<span><span class="co">#&gt; Cod               0           0</span></span>
<span><span class="co">#&gt; Crabs             0           0</span></span>
<span><span class="co">#&gt; Detritus          1           0</span></span>
<span><span class="co">#&gt; Phytoplankton     0           1</span></span>
<span><span class="co">#&gt; Pout              0           0</span></span>
<span><span class="co">#&gt; Sardine           0           0</span></span>
<span><span class="co">#&gt; Shrimps           0           0</span></span>
<span><span class="co">#&gt; Worms             0           0</span></span>
<span><span class="co">#&gt; Zooplankton       0           0</span></span></code></pre></div>
<p>Now we see that the prior distributions are informed by the
literature data:</p>
<ul>
<li><p>when the literature diet input is &gt; 0, the trophic link
probabilities <span class="math inline">\(\eta\)</span> are shifted
toward one. Here this is the case for all prey but we could imagine that
the user identify a species as a plausible prey whereas it has not been
observed being consumed by the predator in the literature. In that case,
the literature diet of 0 would drive <span class="math inline">\(\eta\)</span> toward 0.</p></li>
<li><p>the average prior for the diet proportions <span class="math inline">\(\Pi\)</span> is directly the literature diet
input.</p></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prior.html">plot_prior</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">literature_configuration</span><span class="op">)</span></span></code></pre></div>
<p><img src="realistic_example_files/figure-html/unnamed-chunk-16-1.png" width="768"><img src="realistic_example_files/figure-html/unnamed-chunk-16-2.png" width="768"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prior.html">plot_prior</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">literature_configuration</span>, pred <span class="op">=</span> <span class="st">"Pout"</span><span class="op">)</span></span></code></pre></div>
<p><img src="realistic_example_files/figure-html/unnamed-chunk-17-1.png" width="768"><img src="realistic_example_files/figure-html/unnamed-chunk-17-2.png" width="768"></p>
<p>Again, we verify that the model compiles well:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="st">"mymodel_literature.txt"</span></span>
<span><span class="fu"><a href="../reference/write_model.html">write_model</a></span><span class="op">(</span>file.name <span class="op">=</span> <span class="va">filename</span>, literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span>, print.model <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">mcmc_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span><span class="va">filename</span>, <span class="va">data</span>, run_param<span class="op">=</span><span class="st">"test"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Processing function input....... </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Done. </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Compiling model graph</span></span>
<span><span class="co">#&gt;    Resolving undeclared variables</span></span>
<span><span class="co">#&gt;    Allocating nodes</span></span>
<span><span class="co">#&gt; Graph information:</span></span>
<span><span class="co">#&gt;    Observed stochastic nodes: 316</span></span>
<span><span class="co">#&gt;    Unobserved stochastic nodes: 125</span></span>
<span><span class="co">#&gt;    Total graph size: 1594</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initializing model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adaptive phase, 500 iterations x 3 chains </span></span>
<span><span class="co">#&gt; If no progress bar appears JAGS has decided not to adapt </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Burn-in phase, 500 iterations x 3 chains </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sampling from joint posterior, 500 iterations x 3 chains </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculating statistics....... </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   /!\ Convergence warning:</span></span>
<span><span class="co">#&gt; Out of the 51 variables, 17 variables have a Gelman-Rubin statistic &gt; 1.1.</span></span>
<span><span class="co">#&gt; You may consider modifying the model run settings.</span></span>
<span><span class="co">#&gt; The variables with the poorest convergence are: PI[10,7], PI[8,7], PI[5,7], PI[7,2], PI[10,8], PI[6,2], PI[1,6], PI[3,2], PI[1,3], PI[9,8].</span></span>
<span><span class="co">#&gt; JAGS output for model 'mymodel_literature.txt', generated by jagsUI.</span></span>
<span><span class="co">#&gt; Estimates based on 3 chains of 1000 iterations,</span></span>
<span><span class="co">#&gt; adaptation = 500 iterations (sufficient),</span></span>
<span><span class="co">#&gt; burn-in = 500 iterations and thin rate = 1,</span></span>
<span><span class="co">#&gt; yielding 1500 total samples from the joint posterior. </span></span>
<span><span class="co">#&gt; MCMC ran for 0.234 minutes at time 2024-07-10 10:08:34.460153.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              mean     sd    2.5%     50%   97.5% overlap0 f  Rhat n.eff</span></span>
<span><span class="co">#&gt; eta[4,1]    0.663  0.085   0.499   0.666   0.822    FALSE 1 1.002   834</span></span>
<span><span class="co">#&gt; eta[5,1]    0.609  0.087   0.430   0.611   0.772    FALSE 1 0.999  1500</span></span>
<span><span class="co">#&gt; eta[3,2]    0.366  0.085   0.209   0.365   0.533    FALSE 1 1.003   701</span></span>
<span><span class="co">#&gt; eta[6,2]    0.345  0.079   0.203   0.343   0.507    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[7,2]    0.599  0.087   0.417   0.601   0.762    FALSE 1 1.013   161</span></span>
<span><span class="co">#&gt; eta[8,2]    0.456  0.085   0.289   0.456   0.623    FALSE 1 1.001  1500</span></span>
<span><span class="co">#&gt; eta[9,2]    0.815  0.069   0.665   0.822   0.928    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[1,3]    0.517  0.078   0.361   0.518   0.661    FALSE 1 1.017   115</span></span>
<span><span class="co">#&gt; eta[4,3]    0.719  0.070   0.576   0.723   0.844    FALSE 1 1.001  1500</span></span>
<span><span class="co">#&gt; eta[8,3]    0.845  0.055   0.726   0.851   0.937    FALSE 1 1.004   752</span></span>
<span><span class="co">#&gt; eta[9,3]    0.851  0.055   0.727   0.857   0.943    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[1,6]    0.159  0.064   0.056   0.150   0.310    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[3,6]    0.790  0.069   0.649   0.796   0.908    FALSE 1 1.007   273</span></span>
<span><span class="co">#&gt; eta[8,6]    0.186  0.067   0.074   0.181   0.334    FALSE 1 1.004   540</span></span>
<span><span class="co">#&gt; eta[9,6]    0.970  0.028   0.895   0.978   0.999    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[10,6]   0.880  0.057   0.749   0.887   0.967    FALSE 1 1.001  1500</span></span>
<span><span class="co">#&gt; eta[5,7]    0.563  0.081   0.395   0.565   0.711    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[8,7]    0.974  0.026   0.896   0.982   0.999    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[10,7]   0.358  0.077   0.215   0.355   0.507    FALSE 1 1.038    59</span></span>
<span><span class="co">#&gt; eta[4,8]    0.675  0.093   0.487   0.678   0.841    FALSE 1 1.002   803</span></span>
<span><span class="co">#&gt; eta[5,8]    0.595  0.096   0.408   0.601   0.780    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[9,8]    0.234  0.086   0.088   0.228   0.420    FALSE 1 1.003   637</span></span>
<span><span class="co">#&gt; eta[10,8]   0.305  0.092   0.141   0.300   0.496    FALSE 1 1.001  1500</span></span>
<span><span class="co">#&gt; eta[4,9]    0.957  0.042   0.843   0.970   0.999    FALSE 1 1.006  1500</span></span>
<span><span class="co">#&gt; eta[5,10]   0.958  0.039   0.846   0.969   0.999    FALSE 1 1.002   850</span></span>
<span><span class="co">#&gt; PI[4,1]     0.097  0.209   0.000   0.000   0.810    FALSE 1 1.173    23</span></span>
<span><span class="co">#&gt; PI[5,1]     0.903  0.209   0.190   1.000   1.000    FALSE 1 1.173    23</span></span>
<span><span class="co">#&gt; PI[3,2]     0.402  0.336   0.000   0.341   0.996    FALSE 1 1.307    11</span></span>
<span><span class="co">#&gt; PI[6,2]     0.042  0.133   0.000   0.000   0.538    FALSE 1 1.478    12</span></span>
<span><span class="co">#&gt; PI[7,2]     0.302  0.323   0.000   0.173   0.901    FALSE 1 1.843     5</span></span>
<span><span class="co">#&gt; PI[8,2]     0.155  0.212   0.000   0.058   0.804    FALSE 1 1.120    37</span></span>
<span><span class="co">#&gt; PI[9,2]     0.100  0.119   0.000   0.057   0.420    FALSE 1 1.059    70</span></span>
<span><span class="co">#&gt; PI[1,3]     0.176  0.230   0.000   0.033   0.720    FALSE 1 1.306    11</span></span>
<span><span class="co">#&gt; PI[4,3]     0.099  0.118   0.000   0.054   0.404    FALSE 1 1.016   317</span></span>
<span><span class="co">#&gt; PI[8,3]     0.039  0.093   0.000   0.001   0.321    FALSE 1 1.197    27</span></span>
<span><span class="co">#&gt; PI[9,3]     0.685  0.244   0.154   0.726   0.998    FALSE 1 1.104    25</span></span>
<span><span class="co">#&gt; PI[1,6]     0.127  0.177   0.000   0.030   0.620    FALSE 1 1.405     9</span></span>
<span><span class="co">#&gt; PI[3,6]     0.367  0.260   0.000   0.354   0.883    FALSE 1 1.015   290</span></span>
<span><span class="co">#&gt; PI[8,6]     0.193  0.273   0.000   0.016   0.872    FALSE 1 1.127    27</span></span>
<span><span class="co">#&gt; PI[9,6]     0.279  0.241   0.000   0.237   0.845    FALSE 1 1.084    33</span></span>
<span><span class="co">#&gt; PI[10,6]    0.033  0.077   0.000   0.001   0.263    FALSE 1 1.011  1231</span></span>
<span><span class="co">#&gt; PI[5,7]     0.155  0.190   0.000   0.062   0.600    FALSE 1 2.029     5</span></span>
<span><span class="co">#&gt; PI[8,7]     0.221  0.323   0.000   0.001   0.932    FALSE 1 5.692     3</span></span>
<span><span class="co">#&gt; PI[10,7]    0.624  0.450   0.000   0.919   1.000    FALSE 1 8.790     3</span></span>
<span><span class="co">#&gt; PI[4,8]     0.202  0.201   0.000   0.150   0.716    FALSE 1 1.121    34</span></span>
<span><span class="co">#&gt; PI[5,8]     0.252  0.253   0.000   0.192   0.881    FALSE 1 1.028   213</span></span>
<span><span class="co">#&gt; PI[9,8]     0.432  0.283   0.000   0.468   0.959    FALSE 1 1.218    17</span></span>
<span><span class="co">#&gt; PI[10,8]    0.114  0.264   0.000   0.000   0.936    FALSE 1 1.592     8</span></span>
<span><span class="co">#&gt; PI[4,9]     1.000  0.000   1.000   1.000   1.000    FALSE 1    NA     1</span></span>
<span><span class="co">#&gt; PI[5,10]    1.000  0.000   1.000   1.000   1.000    FALSE 1    NA     1</span></span>
<span><span class="co">#&gt; deviance  867.503 11.272 846.979 867.214 892.252    FALSE 1 1.002  1500</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; **WARNING** Some Rhat values could not be calculated.</span></span>
<span><span class="co">#&gt; **WARNING** Rhat values indicate convergence failure. </span></span>
<span><span class="co">#&gt; Rhat is the potential scale reduction factor (at convergence, Rhat=1). </span></span>
<span><span class="co">#&gt; For each parameter, n.eff is a crude measure of effective sample size. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; overlap0 checks if 0 falls in the parameter's 95% credible interval.</span></span>
<span><span class="co">#&gt; f is the proportion of the posterior with the same sign as the mean;</span></span>
<span><span class="co">#&gt; i.e., our confidence that the parameter is positive or negative.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; DIC info: (pD = var(deviance)/2) </span></span>
<span><span class="co">#&gt; pD = 63.6 and DIC = 931.081 </span></span>
<span><span class="co">#&gt; DIC is an estimate of expected predictive error (lower is better).</span></span></code></pre></div>
<p>You should now try to run the model until it converges (it should
take around <strong>half an hour</strong> to run, so we wonâ€™t do it in
this vignette):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span><span class="va">filename</span>, <span class="va">data</span>, run_param<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nb_iter<span class="op">=</span><span class="fl">100000</span>, nb_burnin<span class="op">=</span><span class="fl">50000</span>, nb_thin<span class="op">=</span><span class="fl">50</span>, nb_adapt<span class="op">=</span><span class="fl">50000</span><span class="op">)</span>, parallelize <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>Here are the figures corresponding to the results that have
converged:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_results.html">plot_results</a></span><span class="op">(</span><span class="va">mcmc_output</span>, <span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/eta_mean_with_lit.png" width="700"></p>
<p><img src="../reference/figures/PI_mean_with_lit.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_results.html">plot_results</a></span><span class="op">(</span><span class="va">mcmc_output</span>, <span class="va">data</span>, pred <span class="op">=</span> <span class="st">"Pout"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/eta_pouts_with_lit.png" width="550"></p>
<p><img src="../reference/figures/PI_pouts_with_lit.png" width="550"></p>
<p>You can save the figures as PNG using:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_results.html">plot_results</a></span><span class="op">(</span><span class="va">mcmc_output</span>, <span class="va">data</span>, pred <span class="op">=</span> <span class="st">"Pout"</span>, save <span class="op">=</span> <span class="cn">TRUE</span>, save_path <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span></code></pre></div>
<p>Last, if you want to explore further in detail the a posteriori
distribution of your parameters <span class="math inline">\(\Pi\)</span>
and <span class="math inline">\(\eta\)</span>, you can run the following
code line, which will store the values for all iterations into a data
frame.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reshape_mcmc</span><span class="op">(</span><span class="va">mcmc_output</span>, <span class="va">data</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Pierre-Yves Hernvann, Didier Gascuel, Dorothee Kopp, Marianne Robert, Jerome Guitton, Etienne Rivot, Heloise Thero.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
