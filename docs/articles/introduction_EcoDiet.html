<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>1. Introduction - How to use EcoDiet • EcoDiet</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="1. Introduction - How to use EcoDiet">
<meta property="og:description" content="EcoDiet">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EcoDiet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction_EcoDiet.html">1. Introduction - How to use EcoDiet</a>
    </li>
    <li>
      <a href="../articles/realistic_example.html">2. EcoDiet explored on a realistic example</a>
    </li>
    <li>
      <a href="../articles/convergence_problems.html">3. How to deal with convergence problems</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pyhernvann/EcoDiet/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>1. Introduction - How to use EcoDiet</h1>
                        <h4 data-toc-skip class="author">Heloise Thero,
Pierre-Yves Hernvann</h4>
            
            <h4 data-toc-skip class="date">2024-07-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pyhernvann/EcoDiet/blob/HEAD/vignettes/introduction_EcoDiet.Rmd" class="external-link"><code>vignettes/introduction_EcoDiet.Rmd</code></a></small>
      <div class="hidden name"><code>introduction_EcoDiet.Rmd</code></div>

    </div>

    
    
<p>EcoDiet is a new tool for assimilating data in food-web studies. The
goal of the package is to quantify trophic interactions between food-web
components by combining stomach content analyses and biotracers in a
Bayesian hierarchical model. To do so, the model simultaneously
estimates a probabilistic topology matrix of the trophic network and the
diet matrix. The topology matrix is a probabilistic description of “who
eats whom” in the food web and is composed of the probabilities that
trophic links exist between food-web components, i.e. the probabilities
<span class="math inline">\(\eta\)</span> that any prey is eaten by a
given predator. The diet matrix is estimated conditionally to this
topology and contains all diet proportions <span class="math inline">\(\Pi\)</span>, hence it expresses the contribution
(in %) of any prey to a given predator’s diet.</p>
<p>The full EcoDiet model and its application to real and simulated
datasets are described in <em>Hernvann et al. 2022, Ecol Appl</em>. Use
<code>citation("EcoDiet")</code> to get the full reference.</p>
<p>Several options are available within the present package:</p>
<ul>
<li><p><em>Default option</em> - only stomach content and biotracer data
are integrated into EcoDiet.</p></li>
<li><p><em>Literature option</em> - stomach content and biotracer data
are integrated and results from expert knowledge or the literature are
used to formulate informative priors on the topology and diet
matrices.</p></li>
</ul>
<p>The example showcased here is an artificial dataset, created to be
simple to visualize and understand. In this example as in <em>Hernvann
et al. 2022, Ecol Appl</em> the biotracers used are stable isotopes but
EcoDiet could be used to treat other analyses (e.g., fatty acids,
specific-compounds stable isotopes).</p>
<p>Before running the following code, please ensure that EcoDiet and the
required tools are correctly installed and set up on your computer.
Instructions can be found in the <a href="https://github.com/pyhernvann/EcoDiet/blob/master/README.md" class="external-link">README</a>’s
instructions. If you’re all set, let’s load the EcoDiet package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pyhernvann/EcoDiet" class="external-link">EcoDiet</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="load-and-check-your-data">1. Load and check your data<a class="anchor" aria-label="anchor" href="#load-and-check-your-data"></a>
</h2>
<p>To apply EcoDiet to your own data, your stomach content, biotracer
and literature data should be in a specific format, similar to those of
following example. This data can for instance be imported into R using
<code>.csv</code> files:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_stomach_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"./data/my_stomach_data.csv"</span><span class="op">)</span></span>
<span><span class="va">example_biotracer_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"./data/my_biotracer_data.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Here we will demonstrate how EcoDiet works on a simulated dataset
stored within the EcoDiet package.</p>
<div class="section level3">
<h3 id="stomach-content-data">Stomach content data<a class="anchor" aria-label="anchor" href="#stomach-content-data"></a>
</h3>
<p>The stomach content table gathers the sum of occurrences of each prey
trophic group in the analyzed stomachs of each consumer trophic group.
The first column of the table contains the names of the prey trophic
groups and the headers of the following columns contain the names of all
the predator trophic groups. The last row of the table should be named
“full”, and indicates how many (non-empty) stomachs have been analyzed
for each trophic group.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_stomach_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_stomach_data.csv"</span>,</span>
<span>                                    package <span class="op">=</span> <span class="st">"EcoDiet"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">example_stomach_data</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">X</th>
<th align="right">huge</th>
<th align="right">large</th>
<th align="right">medium</th>
<th align="right">small</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">huge</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">large</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">medium</td>
<td align="right">9</td>
<td align="right">22</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">small</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">16</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">full</td>
<td align="right">19</td>
<td align="right">24</td>
<td align="right">17</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>In this example, for the “huge” animals, 19 stomachs were analyzed
and contained remainings. Among these stomachs, 11 contained “large”
animal remainings and 9 contained “medium” animal remainings.</p>
<p>If some trophic groups of the studied food web don’t have associated
stomach content analyses, you should add a line in this table indicating
the name of this group and <em>0</em> in the other rows (it is the case
here for “small” animals that are at the base of the trophic
network).</p>
</div>
<div class="section level3">
<h3 id="biotracer-data">Biotracer data<a class="anchor" aria-label="anchor" href="#biotracer-data"></a>
</h3>
<p>The Biotracer table contains the analyses of different tracer
concentrations. Each line of the table represents one individual on
which were conducted biotracer analyses for various elements (here,
stable isotope analyses for carbon and nitrogen). The first column of
the table should be called “group” and contain name of the trophic group
the individual belongs. The rest of the table contains the measures, one
column corresponding to one biotracer.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_biotracer_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_biotracer_data.csv"</span>,</span>
<span>                                    package <span class="op">=</span> <span class="st">"EcoDiet"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">example_biotracer_data</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">group</th>
<th align="right">d13C</th>
<th align="right">d15N</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">medium</td>
<td align="right">-15.64284</td>
<td align="right">13.840550</td>
</tr>
<tr class="even">
<td align="left">medium</td>
<td align="right">-15.56745</td>
<td align="right">12.600720</td>
</tr>
<tr class="odd">
<td align="left">medium</td>
<td align="right">-16.44420</td>
<td align="right">14.037290</td>
</tr>
<tr class="even">
<td align="left">medium</td>
<td align="right">-17.16711</td>
<td align="right">13.133810</td>
</tr>
<tr class="odd">
<td align="left">small</td>
<td align="right">-17.95860</td>
<td align="right">10.443507</td>
</tr>
<tr class="even">
<td align="left">small</td>
<td align="right">-16.56196</td>
<td align="right">10.789742</td>
</tr>
<tr class="odd">
<td align="left">small</td>
<td align="right">-17.04855</td>
<td align="right">11.236032</td>
</tr>
<tr class="even">
<td align="left">small</td>
<td align="right">-17.14060</td>
<td align="right">8.976896</td>
</tr>
<tr class="odd">
<td align="left">small</td>
<td align="right">-16.23605</td>
<td align="right">8.580734</td>
</tr>
<tr class="even">
<td align="left">large</td>
<td align="right">-15.24835</td>
<td align="right">16.433410</td>
</tr>
<tr class="odd">
<td align="left">large</td>
<td align="right">-14.03405</td>
<td align="right">16.299340</td>
</tr>
<tr class="even">
<td align="left">large</td>
<td align="right">-16.76164</td>
<td align="right">17.009600</td>
</tr>
<tr class="odd">
<td align="left">large</td>
<td align="right">-16.53439</td>
<td align="right">15.878830</td>
</tr>
<tr class="even">
<td align="left">large</td>
<td align="right">-14.93301</td>
<td align="right">16.633490</td>
</tr>
<tr class="odd">
<td align="left">huge</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>All the trophic groups of the studied food web should be present in
this biotracer table. Thus, if biotracer analyses are missing for one
given trophic group you still have to enter one line indicating the name
of the trophic group and <em>NA</em> in the following columns (as it is
the case for the “huge” group).</p>
<p>The biotracers like stable isotope analyses are integrated in the
model based on the trophic enrichment concept. Thus, for each biotracer
informed, you also need to define the corresponding trophic
discrimination factors corresponding to your the biotracers. In this
example, we use common trophic discrimination factors for carbon and
nitrogen:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trophic_discrimination_factor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.4</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="preprocess-your-data-without-literature-data-default-option">2. Preprocess your data without literature data (<em>Default
option</em>)<a class="anchor" aria-label="anchor" href="#preprocess-your-data-without-literature-data-default-option"></a>
</h2>
<p><strong>If you have data extracted from the literature, skip this and
go to section 3.</strong></p>
<p>Read this section if you <strong>don’t</strong> want to integrate
information from the literature / expert knowledge. This is specified
using the <code>literature_configuration</code> argument.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">literature_configuration</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
<div class="section level3">
<h3 id="preprocess-the-data">Preprocess the data<a class="anchor" aria-label="anchor" href="#preprocess-the-data"></a>
</h3>
<p>The <code>preprocess_data</code> function checks and rearranges the
input data into a specific format that is read when running the EcoDiet
model:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span><span class="op">(</span>stomach_data <span class="op">=</span> <span class="va">example_stomach_data</span>,</span>
<span>                        biotracer_data <span class="op">=</span> <span class="va">example_biotracer_data</span>,</span>
<span>                        trophic_discrimination_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>                        literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span></span>
<span>                        <span class="op">)</span></span>
<span><span class="co">#&gt; The model will investigate the following trophic links:</span></span>
<span><span class="co">#&gt;        huge large medium small</span></span>
<span><span class="co">#&gt; huge      0     0      0     0</span></span>
<span><span class="co">#&gt; large     1     0      0     0</span></span>
<span><span class="co">#&gt; medium    1     1      0     0</span></span>
<span><span class="co">#&gt; small     0     1      1     0</span></span></code></pre></div>
<p>Error messages will appear if the input data hasn’t been provided in
the expected shape. Please read carefully the error message and
rearrange your data in the correct format.</p>
<p>Stomach content dataset dominated by numerous small values of
occurrence might be problematical as to few groups could be identified
as potential prey. To avoid such situations, you can choose to upscale
the stomach content data so that occurrences are artificially increased
but their relative importance are conserved. This is performed by
specifying <code>rescale_stomach = TRUE</code> when preprocessing the
data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span><span class="op">(</span>biotracer_data <span class="op">=</span> <span class="va">example_biotracer_data</span>,</span>
<span>                        trophic_discrimination_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>                        literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span>,</span>
<span>                        stomach_data <span class="op">=</span> <span class="va">example_stomach_data</span>,</span>
<span>                        rescale_stomach <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; The model will investigate the following trophic links:</span></span>
<span><span class="co">#&gt;        huge large medium small</span></span>
<span><span class="co">#&gt; huge      0     0      0     0</span></span>
<span><span class="co">#&gt; large     1     0      0     0</span></span>
<span><span class="co">#&gt; medium    1     1      0     0</span></span>
<span><span class="co">#&gt; small     0     1      1     0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-the-trophic-links">Check the trophic links<a class="anchor" aria-label="anchor" href="#check-the-trophic-links"></a>
</h3>
<p>By default, the links that will be investigated by the model will be
those derived from at least one observation in the stomach content
analyses. This is a conservative assumption to avoid investigating all
the possible trophic links in the food web, since it would make the
model too complex and require too long runs, while also reduce the
discrimination power of the model (see Hernvann et al. 2022). The
trophic links that will be investigated can be summarized by a fixed
topology computed by the <code>preprocess_data</code> based on stomach
contents (i.e., <code>data$o</code>):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">topology</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">*</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">o</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">topology</span><span class="op">)</span></span>
<span><span class="co">#&gt;        huge large medium small</span></span>
<span><span class="co">#&gt; huge      0     0      0     0</span></span>
<span><span class="co">#&gt; large     1     0      0     0</span></span>
<span><span class="co">#&gt; medium    1     1      0     0</span></span>
<span><span class="co">#&gt; small     0     1      1     0</span></span></code></pre></div>
<p>If you want to add other important link that may not be observed in
scat contents (or, on the contrary, remove false positive trophic links
identified in the stomach contents), you can modify directly this binary
topology matrix. This operation can be useful, for instance, if your
stomach sampling size is too low and you missed a prey you are
definitely sure that the predator feeds on, or if you know that the
identification of a prey will be reduced due to very small size or high
digestibility. To specify that the “huge” animal can also eat “small”
animals, you can do:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">topology</span><span class="op">[</span><span class="st">"small"</span>, <span class="st">"huge"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">topology</span><span class="op">)</span></span>
<span><span class="co">#&gt;        huge large medium small</span></span>
<span><span class="co">#&gt; huge      0     0      0     0</span></span>
<span><span class="co">#&gt; large     1     0      0     0</span></span>
<span><span class="co">#&gt; medium    1     1      0     0</span></span>
<span><span class="co">#&gt; small     1     1      1     0</span></span></code></pre></div>
<p>To run EcoDiet on this updated binary topology, you will have to
append the previous one by re-running the <code>preprocess_data</code>
as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span><span class="op">(</span>biotracer_data <span class="op">=</span> <span class="va">example_biotracer_data</span>,</span>
<span>                        trophic_discrimination_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>                        literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span>,</span>
<span>                        topology <span class="op">=</span> <span class="va">topology</span>,</span>
<span>                        stomach_data <span class="op">=</span> <span class="va">example_stomach_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; The model will investigate the following trophic links:</span></span>
<span><span class="co">#&gt;        huge large medium small</span></span>
<span><span class="co">#&gt; huge      0     0      0     0</span></span>
<span><span class="co">#&gt; large     1     0      0     0</span></span>
<span><span class="co">#&gt; medium    1     1      0     0</span></span>
<span><span class="co">#&gt; small     1     1      1     0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="preprocess-your-data-with-literature-data-literature-option">3. Preprocess your data with literature data (<em>Literature
option</em>)<a class="anchor" aria-label="anchor" href="#preprocess-your-data-with-literature-data-literature-option"></a>
</h2>
<p><strong>If you don’t have data extracted from the literature, skip
this and go to section 4.</strong></p>
<p>Read this section if you <strong>do</strong> want to integrate
information from the literature / expert knowledge. This is specified
using the <code>literature_configuration</code> argument.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">literature_configuration</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></code></pre></div>
<div class="section level3">
<h3 id="define-the-priors">Define the priors<a class="anchor" aria-label="anchor" href="#define-the-priors"></a>
</h3>
<p>A literature diet table is used to set priors on the trophic link
probabilities <span class="math inline">\(\eta\)</span> and the diet
proportions <span class="math inline">\(\Pi\)</span>. This table is
similar to the stomach contents table, as all trophic groups must be
included in the columns and rows. The numbers are the average diet
proportions found in the literature. Here, the selected studies have
identified that “huge” animals eat equally “large” and “medium” animals
(thus the 0.5 and 0.5 numbers in the first column). The proportions for
a given predator (i.e., within a given column) must sum to 1. The
“small” animals are at the base of the ecosystem, so the column is
filled with zeros.</p>
<p>The last row of the table corresponds to the literature pedigree
score. This score (a number from 0 to 1) quantifies the literature
reliability on each predator’s diet. Here the dietary proportions from
the literature are used to produce reliable estimates for the “huge”
animals, e.g., the pedigree score associated is high (0.9). On the
contrary, the diet proportions for the “medium” animals come from an
older article focusing on a very different ecosystem so estimates
produced are less reliable, e.g, the pedigree score is low (0.2). The
pedigree score for the “small” animals is set at 1, because this group
eats nothing. For more details please read the reference article.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_literature_diets_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_literature_diets.csv"</span>,</span>
<span>                                    package <span class="op">=</span> <span class="st">"EcoDiet"</span><span class="op">)</span></span>
<span><span class="va">example_literature_diets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">example_literature_diets_path</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">example_literature_diets</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">X</th>
<th align="right">huge</th>
<th align="right">large</th>
<th align="right">medium</th>
<th align="right">small</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">huge</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">large</td>
<td align="right">0.5</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">medium</td>
<td align="right">0.5</td>
<td align="right">0.7</td>
<td align="right">0.0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">small</td>
<td align="right">0.0</td>
<td align="right">0.3</td>
<td align="right">1.0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">pedigree</td>
<td align="right">0.9</td>
<td align="right">0.6</td>
<td align="right">0.2</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>This summary of the literature data will be used to formulate:</p>
<ol style="list-style-type: decimal">
<li><p>The priors on the topology matrix’s <span class="math inline">\(\eta\)</span>s. If a given literature diet
proportion is zero, the corresponding prior Beta distribution of <span class="math inline">\(\eta\)</span> will be shifted toward 0. If the
proportion is positive, the distribution will be shifted toward
1.</p></li>
<li><p>The priors on the diet matrix’s <span class="math inline">\(\Pi\)</span>s. The literature diet proportions are
entered as the hyperparameters of the prior Dirichlet distribution of
<span class="math inline">\(\Pi\)</span>.</p></li>
</ol>
<p>The Pedigree scores are used to determine the priors’ precision.
Other parameters can be used to adjust the prior distributions:</p>
<ul>
<li>the <code>nb_literature</code> parameter. The higher the number, the
stronger the weight will be of the literature in the final inference on
<span class="math inline">\(\eta\)</span>. Setting this parameter to 10
is like saying that the prior from the literature will weigh as much as
the additional data from 10 stomachs. Thus for any particular
application, <code>nb_literature</code> should be set to a value smaller
than the sample size in the available stomach content data.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nb_literature</span> <span class="op">=</span> <span class="fl">10</span></span></code></pre></div>
<ul>
<li>the <code>literature_slope</code> parameter (a value between 0 and
1). The higher the number, the stronger the weight will be of the
literature in the final inference on <span class="math inline">\(\Pi\)</span>. You should set this value depending
on the value of your data (number of biotracers, etc).</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">literature_slope</span> <span class="op">=</span> <span class="fl">0.5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="preprocess-the-data-1">Preprocess the data<a class="anchor" aria-label="anchor" href="#preprocess-the-data-1"></a>
</h3>
<p>The <code>preprocess_data</code> function then checks and rearranges
the data in a specific format so that the EcoDiet model can be run:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span><span class="op">(</span>biotracer_data <span class="op">=</span> <span class="va">example_biotracer_data</span>,</span>
<span>                        trophic_discrimination_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>                        literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span>,</span>
<span>                        stomach_data <span class="op">=</span> <span class="va">example_stomach_data</span>,</span>
<span>                        literature_diets <span class="op">=</span> <span class="va">example_literature_diets</span>,</span>
<span>                        nb_literature <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        literature_slope <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; The model will investigate the following trophic links:</span></span>
<span><span class="co">#&gt;        huge large medium small</span></span>
<span><span class="co">#&gt; huge      0     0      0     0</span></span>
<span><span class="co">#&gt; large     1     0      0     0</span></span>
<span><span class="co">#&gt; medium    1     1      0     0</span></span>
<span><span class="co">#&gt; small     0     1      1     0</span></span></code></pre></div>
<p>If any error appears, it means your data is not in the correct
format. Please read the error message and try to rearrange the data in
the correct format.</p>
<p>If you have a lot of small values in the stomach occurrences, you can
choose to upscale the stomach content data:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span><span class="op">(</span>biotracer_data <span class="op">=</span> <span class="va">example_biotracer_data</span>,</span>
<span>                        trophic_discrimination_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>                        literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span>,</span>
<span>                        stomach_data <span class="op">=</span> <span class="va">example_stomach_data</span>,</span>
<span>                        rescale_stomach <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                        literature_diets <span class="op">=</span> <span class="va">example_literature_diets</span>,</span>
<span>                        nb_literature <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        literature_slope <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; The model will investigate the following trophic links:</span></span>
<span><span class="co">#&gt;        huge large medium small</span></span>
<span><span class="co">#&gt; huge      0     0      0     0</span></span>
<span><span class="co">#&gt; large     1     0      0     0</span></span>
<span><span class="co">#&gt; medium    1     1      0     0</span></span>
<span><span class="co">#&gt; small     0     1      1     0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-the-trophic-links-to-investigate">Check the trophic links to investigate<a class="anchor" aria-label="anchor" href="#check-the-trophic-links-to-investigate"></a>
</h3>
<p>These are the links that will be investigated by the model. It is not
wise to assume that all the trophic links are possible. You therefore
need to keep only the reasonable trophic links (e.g., a shrimp cannot
eat a whale). The matrix displayed by the <code>preprocess_data</code>
function is based by default on the stomach content data
(<code>data$o</code>) and on the literature diet matrix
(<code>data$alpha_lit</code>):</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">topology</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">o</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">alpha_lit</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">topology</span><span class="op">)</span></span>
<span><span class="co">#&gt;        huge large medium small</span></span>
<span><span class="co">#&gt; huge      0     0      0     0</span></span>
<span><span class="co">#&gt; large     1     0      0     0</span></span>
<span><span class="co">#&gt; medium    1     1      0     0</span></span>
<span><span class="co">#&gt; small     0     1      1     0</span></span></code></pre></div>
<p>If you want to add another trophic link, you can modify directly the
binary topology matrix. It can be useful if you are sure that a prey is
consumed by a given predator. However the trophic link is not observed
in the stomach content data, and the study extracted from the literature
did not identify the prey. To specify that the “huge” animal can also
eat “small” animals, you can do:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">topology</span><span class="op">[</span><span class="st">"small"</span>, <span class="st">"huge"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">topology</span><span class="op">)</span></span>
<span><span class="co">#&gt;        huge large medium small</span></span>
<span><span class="co">#&gt; huge      0     0      0     0</span></span>
<span><span class="co">#&gt; large     1     0      0     0</span></span>
<span><span class="co">#&gt; medium    1     1      0     0</span></span>
<span><span class="co">#&gt; small     1     1      1     0</span></span></code></pre></div>
<p>The new topology matrix can now be entered as an argument of the
<code>preprocess_data</code> function:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span><span class="op">(</span>biotracer_data <span class="op">=</span> <span class="va">example_biotracer_data</span>,</span>
<span>                        trophic_discrimination_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>                        literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span>,</span>
<span>                        topology <span class="op">=</span> <span class="va">topology</span>,</span>
<span>                        stomach_data <span class="op">=</span> <span class="va">example_stomach_data</span>,</span>
<span>                        literature_diets <span class="op">=</span> <span class="va">example_literature_diets</span>,</span>
<span>                        nb_literature <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        literature_slope <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; The model will investigate the following trophic links:</span></span>
<span><span class="co">#&gt;        huge large medium small</span></span>
<span><span class="co">#&gt; huge      0     0      0     0</span></span>
<span><span class="co">#&gt; large     1     0      0     0</span></span>
<span><span class="co">#&gt; medium    1     1      0     0</span></span>
<span><span class="co">#&gt; small     1     1      1     0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="plot-the-data-and-the-priors">4. Plot the data and the priors<a class="anchor" aria-label="anchor" href="#plot-the-data-and-the-priors"></a>
</h2>
<p>You can visualize your data with the <code>plot_data</code>
function:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_data.html">plot_data</a></span><span class="op">(</span>biotracer_data <span class="op">=</span> <span class="va">example_biotracer_data</span>,</span>
<span>          stomach_data <span class="op">=</span> <span class="va">example_stomach_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_EcoDiet_files/figure-html/fig1-1.png" width="576"></p>
<pre><code><span><span class="co">#&gt; Warning: Use of `biotracer_data$group` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `group` instead.</span></span></code></pre>
<p><img src="introduction_EcoDiet_files/figure-html/fig1-2.png" width="576"></p>
<p>You can save the figures as PNG in the current folder using:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_data.html">plot_data</a></span><span class="op">(</span>biotracer_data <span class="op">=</span> <span class="va">example_biotracer_data</span>,</span>
<span>          stomach_data <span class="op">=</span> <span class="va">example_stomach_data</span>,</span>
<span>          save <span class="op">=</span> <span class="cn">TRUE</span>, save_path <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span></code></pre></div>
<p>Whether the priors are non-informative or informed by the literature,
you can plot the mean of the prior distributions for the trophic link
probabilities <span class="math inline">\(\eta\)</span> and the diet
proportions <span class="math inline">\(\Pi\)</span>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prior.html">plot_prior</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">literature_configuration</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_EcoDiet_files/figure-html/unnamed-chunk-23-1.png" width="576"><img src="introduction_EcoDiet_files/figure-html/unnamed-chunk-23-2.png" width="576"></p>
<p>You can also see the prior distributions for one trophic group (or
predator):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_prior.html">plot_prior</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">literature_configuration</span>, pred <span class="op">=</span> <span class="st">"huge"</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_EcoDiet_files/figure-html/unnamed-chunk-24-1.png" width="576"><img src="introduction_EcoDiet_files/figure-html/unnamed-chunk-24-2.png" width="576"></p>
<p>This way, you can change the prior parameters and see how it affects
the prior distributions. Here, we will change the
<code>nb_literature</code> parameter from 10 to 2:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span><span class="op">(</span>biotracer_data <span class="op">=</span> <span class="va">example_biotracer_data</span>,</span>
<span>                        trophic_discrimination_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>                        literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span>,</span>
<span>                        topology <span class="op">=</span> <span class="va">topology</span>,</span>
<span>                        stomach_data <span class="op">=</span> <span class="va">example_stomach_data</span>,</span>
<span>                        literature_diets <span class="op">=</span> <span class="va">example_literature_diets</span>,</span>
<span>                        nb_literature <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                        literature_slope <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; The model will investigate the following trophic links:</span></span>
<span><span class="co">#&gt;        huge large medium small</span></span>
<span><span class="co">#&gt; huge      0     0      0     0</span></span>
<span><span class="co">#&gt; large     1     0      0     0</span></span>
<span><span class="co">#&gt; medium    1     1      0     0</span></span>
<span><span class="co">#&gt; small     1     1      1     0</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_prior.html">plot_prior</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">literature_configuration</span>, pred <span class="op">=</span> <span class="st">"huge"</span>, variable <span class="op">=</span> <span class="st">"eta"</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_EcoDiet_files/figure-html/unnamed-chunk-25-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="run-the-model">5. Run the model<a class="anchor" aria-label="anchor" href="#run-the-model"></a>
</h2>
<p>The <code>write_model</code> function writes the model in the BUGS
syntax. Here You need to specify whether you want to use or not priors
form the literature since the model structure will be affected by this
choice. The model is written as a <em>.txt</em> for which you should
specify a path and name through the <code>file.name</code> argument.</p>
<p>To see the written model, you can turn on visualization using
<code>print.model=TRUE</code> or opening the saved <em>.txt</em>
file</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="st">"mymodel.txt"</span></span>
<span><span class="fu"><a href="../reference/write_model.html">write_model</a></span><span class="op">(</span>file.name <span class="op">=</span> <span class="va">filename</span>, literature_configuration <span class="op">=</span> <span class="va">literature_configuration</span>, print.model <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>First, run the model as a test (i.e., low adaption phase and low
number of iterations) to check that the model is compiling properly.
Specifying <code>run_param="test"</code> will by default run the model
with nb_iter=1000 and nb_burnin=500.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span><span class="va">filename</span>, <span class="va">data</span>, run_param <span class="op">=</span> <span class="st">"test"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Processing function input....... </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Done. </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Compiling model graph</span></span>
<span><span class="co">#&gt;    Resolving undeclared variables</span></span>
<span><span class="co">#&gt;    Allocating nodes</span></span>
<span><span class="co">#&gt; Graph information:</span></span>
<span><span class="co">#&gt;    Observed stochastic nodes: 20</span></span>
<span><span class="co">#&gt;    Unobserved stochastic nodes: 41</span></span>
<span><span class="co">#&gt;    Total graph size: 393</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initializing model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adaptive phase, 500 iterations x 3 chains </span></span>
<span><span class="co">#&gt; If no progress bar appears JAGS has decided not to adapt </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Burn-in phase, 500 iterations x 3 chains </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sampling from joint posterior, 500 iterations x 3 chains </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculating statistics....... </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Done.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   /!\ Convergence warning:</span></span>
<span><span class="co">#&gt; Out of the 13 variables, 5 variables have a Gelman-Rubin statistic &gt; 1.1.</span></span>
<span><span class="co">#&gt; You may consider modifying the model run settings.</span></span>
<span><span class="co">#&gt; The variables with the poorest convergence are: PI[3,2], PI[4,2], PI[2,1], PI[3,1], PI[4,1].</span></span>
<span><span class="co">#&gt; JAGS output for model 'mymodel.txt', generated by jagsUI.</span></span>
<span><span class="co">#&gt; Estimates based on 3 chains of 1000 iterations,</span></span>
<span><span class="co">#&gt; adaptation = 500 iterations (sufficient),</span></span>
<span><span class="co">#&gt; burn-in = 500 iterations and thin rate = 1,</span></span>
<span><span class="co">#&gt; yielding 1500 total samples from the joint posterior. </span></span>
<span><span class="co">#&gt; MCMC ran for 0.016 minutes at time 2024-07-10 10:08:03.96874.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            mean    sd   2.5%    50%  97.5% overlap0 f  Rhat n.eff</span></span>
<span><span class="co">#&gt; eta[2,1]  0.604 0.098  0.410  0.606  0.792    FALSE 1 1.008   240</span></span>
<span><span class="co">#&gt; eta[3,1]  0.516 0.102  0.319  0.516  0.712    FALSE 1 1.003   517</span></span>
<span><span class="co">#&gt; eta[4,1]  0.042 0.040  0.001  0.029  0.155    FALSE 1 1.001  1500</span></span>
<span><span class="co">#&gt; eta[3,2]  0.894 0.058  0.760  0.904  0.980    FALSE 1 1.000  1500</span></span>
<span><span class="co">#&gt; eta[4,2]  0.193 0.074  0.067  0.187  0.348    FALSE 1 1.006   423</span></span>
<span><span class="co">#&gt; eta[4,3]  0.898 0.067  0.722  0.910  0.986    FALSE 1 1.004   906</span></span>
<span><span class="co">#&gt; PI[2,1]   0.480 0.415  0.000  0.478  1.000    FALSE 1 1.295    11</span></span>
<span><span class="co">#&gt; PI[3,1]   0.512 0.414  0.000  0.516  1.000    FALSE 1 1.282    11</span></span>
<span><span class="co">#&gt; PI[4,1]   0.008 0.042  0.000  0.000  0.094    FALSE 1 1.266    60</span></span>
<span><span class="co">#&gt; PI[3,2]   0.915 0.198  0.273  1.000  1.000    FALSE 1 1.511    10</span></span>
<span><span class="co">#&gt; PI[4,2]   0.085 0.198  0.000  0.000  0.727    FALSE 1 1.511    10</span></span>
<span><span class="co">#&gt; PI[4,3]   1.000 0.000  1.000  1.000  1.000    FALSE 1    NA     1</span></span>
<span><span class="co">#&gt; deviance 76.117 6.231 65.667 75.401 89.752    FALSE 1 1.001   996</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; **WARNING** Some Rhat values could not be calculated.</span></span>
<span><span class="co">#&gt; **WARNING** Rhat values indicate convergence failure. </span></span>
<span><span class="co">#&gt; Rhat is the potential scale reduction factor (at convergence, Rhat=1). </span></span>
<span><span class="co">#&gt; For each parameter, n.eff is a crude measure of effective sample size. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; overlap0 checks if 0 falls in the parameter's 95% credible interval.</span></span>
<span><span class="co">#&gt; f is the proportion of the posterior with the same sign as the mean;</span></span>
<span><span class="co">#&gt; i.e., our confidence that the parameter is positive or negative.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; DIC info: (pD = var(deviance)/2) </span></span>
<span><span class="co">#&gt; pD = 19.4 and DIC = 95.519 </span></span>
<span><span class="co">#&gt; DIC is an estimate of expected predictive error (lower is better).</span></span></code></pre></div>
<p>The low numbers won’t be enough to achieve a satisfactory model
convergence. You should progressively increase the number of adaptation
steps <code>nb_adapt</code> and of iterations <code>nb_iter</code> while
checking the “Convergence warnings” message. You can specify these model
run parameters by specifying
<code>run_param=list(nb_iter=iter, nb_burnin=burnin, nb_thin=thin)</code>.
There are also a couple of default run parameters (<em>“very
short”</em>,<em>“short”</em>,<em>“normal”</em>,<em>“long”</em>,<em>“very
long”</em>) that you can use in the with <code>run_param</code> and
learn about by calling <code>?run_param</code></p>
<p>Be aware that, depending on your data and especially the number of
trophic groups and investigate trophic interactions, the model can take
<strong>hours or days</strong> to run.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span><span class="va">filename</span>, <span class="va">data</span>, run_param<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nb_iter<span class="op">=</span><span class="fl">10000</span>, nb_burnin<span class="op">=</span><span class="fl">5000</span>, nb_thin<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mcmc_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span><span class="va">filename</span>, <span class="va">data</span>, run_param<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nb_iter<span class="op">=</span><span class="fl">50000</span>, nb_burnin<span class="op">=</span><span class="fl">25000</span>, nb_thin<span class="op">=</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mcmc_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span><span class="va">filename</span>, <span class="va">data</span>, run_param<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nb_iter<span class="op">=</span><span class="fl">100000</span>, nb_burnin<span class="op">=</span><span class="fl">50000</span>, nb_thin<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mcmc_output_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span><span class="va">filename</span>, <span class="va">data</span>, run_param<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nb_iter<span class="op">=</span><span class="fl">50000</span>, nb_burnin<span class="op">=</span><span class="fl">25000</span>, nb_thin<span class="op">=</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that for much complex case studies, the dimension of the model
may be considerable hence the time required by the runs may be
dramatically long. In that context, while analyzing your results
carefully, you might be willing to use your model outputs if a only a
very limited number of variables don’t reach convergence after
especially long runs.</p>
<p>Once a model reaches convergence objectives, don’t forget to save it
on your machine.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">mcmc_output_example</span>, file <span class="op">=</span> <span class="st">"./data/mcmc_output_example.rda"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="diagnoses">Diagnoses<a class="anchor" aria-label="anchor" href="#diagnoses"></a>
</h3>
<p>Here we provide the <code>diagnose_model</code> function to perform
simple diagnoses on the EcoDiet run. It displays the number of variables
for which the Gelman-Rubin test remains higher than different
thresholds, highlighting also the 10 worst variables in terms of
convergence. The object created contains these values for all the model
variables.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Gelman_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diagnose_model.html">diagnose_model</a></span><span class="op">(</span><span class="va">mcmc_output_example</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ################################################################################</span></span>
<span><span class="co">#&gt; # Gelman-Rubin Diagnostic</span></span>
<span><span class="co">#&gt; ################################################################################</span></span>
<span><span class="co">#&gt; In EcoDiet, we recommend a that Gelman diagnostic is &lt; 1.1</span></span>
<span><span class="co">#&gt; Out of 11 variables: </span></span>
<span><span class="co">#&gt;                       0 &gt; 1.01</span></span>
<span><span class="co">#&gt;                       0 &gt; 1.05</span></span>
<span><span class="co">#&gt;                       0 &gt; 1.1</span></span>
<span><span class="co">#&gt; The worst variables are:</span></span>
<span><span class="co">#&gt;          Point est. Upper C.I.</span></span>
<span><span class="co">#&gt; PI[2,1]    1.006849   1.025859</span></span>
<span><span class="co">#&gt; PI[3,1]    1.006849   1.025859</span></span>
<span><span class="co">#&gt; PI[3,2]    1.004532   1.009351</span></span>
<span><span class="co">#&gt; PI[4,2]    1.004532   1.009351</span></span>
<span><span class="co">#&gt; eta[3,1]   1.001312   1.004666</span></span>
<span><span class="co">#&gt; eta[4,3]   1.001031   1.002551</span></span>
<span><span class="co">#&gt; eta[4,2]   1.000933   1.004568</span></span>
<span><span class="co">#&gt; eta[2,1]   1.000618   1.001747</span></span>
<span><span class="co">#&gt; eta[3,2]   1.000299   1.002006</span></span>
<span><span class="co">#&gt; deviance   1.000124   1.001733</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Gelman_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; $gelman</span></span>
<span><span class="co">#&gt;          Point est. Upper C.I.</span></span>
<span><span class="co">#&gt; eta[2,1]   1.000618   1.001747</span></span>
<span><span class="co">#&gt; eta[3,1]   1.001312   1.004666</span></span>
<span><span class="co">#&gt; eta[3,2]   1.000299   1.002006</span></span>
<span><span class="co">#&gt; eta[4,2]   1.000933   1.004568</span></span>
<span><span class="co">#&gt; eta[4,3]   1.001031   1.002551</span></span>
<span><span class="co">#&gt; PI[2,1]    1.006849   1.025859</span></span>
<span><span class="co">#&gt; PI[3,1]    1.006849   1.025859</span></span>
<span><span class="co">#&gt; PI[3,2]    1.004532   1.009351</span></span>
<span><span class="co">#&gt; PI[4,2]    1.004532   1.009351</span></span>
<span><span class="co">#&gt; deviance   1.000124   1.001733</span></span></code></pre></div>
<p>The function can also be used to produce diagnostic plots and save
them as a <em>.pdf</em> file. Complex models will have so many variables
that the process can be very long so the user can also specify the
variable for which graphs should be produced and stored.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/diagnose_model.html">diagnose_model</a></span><span class="op">(</span><span class="va">mcmc_output_example</span>, var.to.diag <span class="op">=</span> <span class="st">"all"</span>, save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="plot-and-save-the-results">6. Plot and save the results<a class="anchor" aria-label="anchor" href="#plot-and-save-the-results"></a>
</h2>
<p>The object output by the <code>run_model</code> function contains all
MCMC samples, summary statistics and the configuration of the run:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mcmc_output_example</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 24</span></span>
<span><span class="co">#&gt;  $ sims.list  :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:3000, 1:4, 1:3] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : num [1:3000, 1:4, 1:3] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num [1:3000] 73.8 89.2 75.8 80.1 82 ...</span></span>
<span><span class="co">#&gt;  $ mean       :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:4, 1:3] NA 0.699 0.63 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : num [1:4, 1:3] NA 0.51 0.49 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 75.8</span></span>
<span><span class="co">#&gt;  $ sd         :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:4, 1:3] NA 0.0824 0.0875 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : num [1:4, 1:3] NA 0.378 0.378 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 6.1</span></span>
<span><span class="co">#&gt;  $ q2.5       :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:4, 1:3] NA 0.532 0.446 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : num [1:4, 1:3] NA 4.57e-11 1.09e-11 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 65.7</span></span>
<span><span class="co">#&gt;  $ q25        :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:4, 1:3] NA 0.644 0.572 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : num [1:4, 1:3] NA 0.1275 0.0806 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 71.5</span></span>
<span><span class="co">#&gt;  $ q50        :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:4, 1:3] NA 0.705 0.634 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : num [1:4, 1:3] NA 0.503 0.497 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 75.2</span></span>
<span><span class="co">#&gt;  $ q75        :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:4, 1:3] NA 0.758 0.69 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : num [1:4, 1:3] NA 0.919 0.873 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 79.6</span></span>
<span><span class="co">#&gt;  $ q97.5      :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:4, 1:3] NA 0.848 0.794 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : num [1:4, 1:3] NA 1 1 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 89.2</span></span>
<span><span class="co">#&gt;  $ overlap0   :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : logi [1:4, 1:3] NA FALSE FALSE NA NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : logi [1:4, 1:3] NA FALSE FALSE NA NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: logi FALSE</span></span>
<span><span class="co">#&gt;  $ f          :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:4, 1:3] NA 1 1 NA NA NA 1 1 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : num [1:4, 1:3] NA 1 1 NA NA NA 1 1 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 1</span></span>
<span><span class="co">#&gt;  $ Rhat       :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:4, 1:3] NA 1 1 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : num [1:4, 1:3] NA 1.01 1.01 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 1</span></span>
<span><span class="co">#&gt;  $ n.eff      :List of 3</span></span>
<span><span class="co">#&gt;   ..$ eta     : num [1:4, 1:3] NA 3000 1606 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ PI      : num [1:4, 1:3] NA 281 281 NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 3000</span></span>
<span><span class="co">#&gt;  $ pD         : num 18.6</span></span>
<span><span class="co">#&gt;  $ DIC        : num 94.4</span></span>
<span><span class="co">#&gt;  $ summary    : num [1:11, 1:11] 0.699 0.63 0.907 0.31 0.906 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:11] "eta[2,1]" "eta[3,1]" "eta[3,2]" "eta[4,2]" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:11] "mean" "sd" "2.5%" "25%" ...</span></span>
<span><span class="co">#&gt;  $ samples    :List of 3</span></span>
<span><span class="co">#&gt;   ..$ : 'mcmc' num [1:1000, 1:11] 0.591 0.639 0.775 0.722 0.676 ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. .. ..$ : chr [1:11] "eta[2,1]" "eta[3,1]" "eta[3,2]" "eta[4,2]" ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "mcpar")= num [1:3] 2e+05 3e+05 1e+02</span></span>
<span><span class="co">#&gt;   ..$ : 'mcmc' num [1:1000, 1:11] 0.581 0.616 0.722 0.744 0.6 ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. .. ..$ : chr [1:11] "eta[2,1]" "eta[3,1]" "eta[3,2]" "eta[4,2]" ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "mcpar")= num [1:3] 2e+05 3e+05 1e+02</span></span>
<span><span class="co">#&gt;   ..$ : 'mcmc' num [1:1000, 1:11] 0.623 0.804 0.627 0.701 0.721 ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. .. ..$ : chr [1:11] "eta[2,1]" "eta[3,1]" "eta[3,2]" "eta[4,2]" ...</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "mcpar")= num [1:3] 2e+05 3e+05 1e+02</span></span>
<span><span class="co">#&gt;   ..- attr(*, "class")= chr "mcmc.list"</span></span>
<span><span class="co">#&gt;  $ modfile    : chr "mymodel.txt"</span></span>
<span><span class="co">#&gt;  $ model      :List of 3</span></span>
<span><span class="co">#&gt;   ..$ cluster1:List of 8</span></span>
<span><span class="co">#&gt;   .. ..$ ptr      :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ data     :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ model    :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ state    :function (internal = FALSE)  </span></span>
<span><span class="co">#&gt;   .. ..$ nchain   :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ iter     :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ sync     :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ recompile:function ()  </span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "class")= chr "jags"</span></span>
<span><span class="co">#&gt;   ..$ cluster2:List of 8</span></span>
<span><span class="co">#&gt;   .. ..$ ptr      :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ data     :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ model    :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ state    :function (internal = FALSE)  </span></span>
<span><span class="co">#&gt;   .. ..$ nchain   :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ iter     :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ sync     :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ recompile:function ()  </span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "class")= chr "jags"</span></span>
<span><span class="co">#&gt;   ..$ cluster3:List of 8</span></span>
<span><span class="co">#&gt;   .. ..$ ptr      :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ data     :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ model    :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ state    :function (internal = FALSE)  </span></span>
<span><span class="co">#&gt;   .. ..$ nchain   :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ iter     :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ sync     :function ()  </span></span>
<span><span class="co">#&gt;   .. ..$ recompile:function ()  </span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "class")= chr "jags"</span></span>
<span><span class="co">#&gt;  $ parameters : chr [1:3] "eta" "PI" "deviance"</span></span>
<span><span class="co">#&gt;  $ mcmc.info  :List of 10</span></span>
<span><span class="co">#&gt;   ..$ n.chains        : num 3</span></span>
<span><span class="co">#&gt;   ..$ n.adapt         : num [1:3] 100 100 100</span></span>
<span><span class="co">#&gt;   ..$ sufficient.adapt: logi [1:3] TRUE TRUE TRUE</span></span>
<span><span class="co">#&gt;   ..$ n.iter          : num 3e+05</span></span>
<span><span class="co">#&gt;   ..$ n.burnin        : num 2e+05</span></span>
<span><span class="co">#&gt;   ..$ n.thin          : num 100</span></span>
<span><span class="co">#&gt;   ..$ n.samples       : num 3000</span></span>
<span><span class="co">#&gt;   ..$ end.values      :List of 3</span></span>
<span><span class="co">#&gt;   .. ..$ : Named num [1:11] 0.03392 0.96608 0.99163 0.00837 1 ...</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "names")= chr [1:11] "PI[2,1]" "PI[3,1]" "PI[3,2]" "PI[4,2]" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : Named num [1:11] 1.00 3.19e-07 9.48e-01 5.22e-02 1.00 ...</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "names")= chr [1:11] "PI[2,1]" "PI[3,1]" "PI[3,2]" "PI[4,2]" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : Named num [1:11] 0.000195 0.999805 0.998672 0.001328 1 ...</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "names")= chr [1:11] "PI[2,1]" "PI[3,1]" "PI[3,2]" "PI[4,2]" ...</span></span>
<span><span class="co">#&gt;   ..$ elapsed.mins    : num 1.72</span></span>
<span><span class="co">#&gt;   ..$ n.cores         : num 3</span></span>
<span><span class="co">#&gt;  $ run.date   : POSIXct[1:1], format: "2022-12-28 22:02:18"</span></span>
<span><span class="co">#&gt;  $ parallel   : logi TRUE</span></span>
<span><span class="co">#&gt;  $ bugs.format: logi FALSE</span></span>
<span><span class="co">#&gt;  $ calc.DIC   : logi TRUE</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "jagsUI"</span></span></code></pre></div>
<p>Please read the documentation of the <a href="https://CRAN.R-project.org/package=jagsUI" class="external-link">jagsUI package</a> for
more information.</p>
<p>Below we provide some functions to for a simple exploration of the
results.</p>
<div class="section level3">
<h3 id="the-mean-results">The mean results<a class="anchor" aria-label="anchor" href="#the-mean-results"></a>
</h3>
<p>The model’s outputs are the approximated <em>a posteriori</em>
distributions for the trophic links probabilities <span class="math inline">\(\eta\)</span> and the diet proportions <span class="math inline">\(\Pi\)</span>. You can visualize the mean of these
distributions with the <code>plot_results</code> function:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_results.html">plot_results</a></span><span class="op">(</span><span class="va">mcmc_output_example</span>, <span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_EcoDiet_files/figure-html/unnamed-chunk-33-1.png" width="576"><img src="introduction_EcoDiet_files/figure-html/unnamed-chunk-33-2.png" width="576"></p>
<p>You can access the main statistics by variable directly from the
<code>jagsUI</code> object returned by the r<code>run_model</code>
function, including the mean value of the variables:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mcmc_output_example</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span>,<span class="st">"mean"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   eta[2,1]   eta[3,1]   eta[3,2]   eta[4,2]   eta[4,3]    PI[2,1]    PI[3,1] </span></span>
<span><span class="co">#&gt;  0.6989887  0.6298710  0.9065303  0.3095975  0.9057456  0.5103627  0.4896373 </span></span>
<span><span class="co">#&gt;    PI[3,2]    PI[4,2]    PI[4,3]   deviance </span></span>
<span><span class="co">#&gt;  0.8851660  0.1148340  1.0000000 75.8304573</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-probability-distributions">The probability distributions<a class="anchor" aria-label="anchor" href="#the-probability-distributions"></a>
</h3>
<p>The probability distributions can be plotted for one predator:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_results.html">plot_results</a></span><span class="op">(</span><span class="va">mcmc_output_example</span>, <span class="va">data</span>, pred <span class="op">=</span> <span class="st">"huge"</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_EcoDiet_files/figure-html/unnamed-chunk-35-1.png" width="576"><img src="introduction_EcoDiet_files/figure-html/unnamed-chunk-35-2.png" width="576"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_results.html">plot_results</a></span><span class="op">(</span><span class="va">mcmc_output_example</span>, <span class="va">data</span>, pred <span class="op">=</span> <span class="st">"large"</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_EcoDiet_files/figure-html/unnamed-chunk-36-1.png" width="576"><img src="introduction_EcoDiet_files/figure-html/unnamed-chunk-36-2.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="save-another-variable-than-pi-and-eta">7. Save another variable than <span class="math inline">\(\Pi\)</span> and <span class="math inline">\(\eta\)</span><a class="anchor" aria-label="anchor" href="#save-another-variable-than-pi-and-eta"></a>
</h2>
<p>You actually have the possibility to monitor and output the
statistics of all the model parameters. For example you may be
interested by the variable <span class="math inline">\(\delta\)</span>
that represents the trophic discrimination factor. In the EcoDiet model,
a different trophic discrimination factor is used for each trophic group
and for each element, allowing some differences between species. We can
chose to monitor these parameters when running the model by using the
<code>variables_to_save</code> argument:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc_output_delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span><span class="va">filename</span>, <span class="va">data</span>, </span>
<span>          variables_to_save <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta"</span><span class="op">)</span>,</span>
<span>          run_param <span class="op">=</span> <span class="st">"test"</span><span class="op">)</span></span></code></pre></div>
<p>And now you can access the mean value using:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mcmc_output_delta</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span>,<span class="st">"mean"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Pierre-Yves Hernvann, Didier Gascuel, Dorothee Kopp, Marianne Robert, Jerome Guitton, Etienne Rivot, Heloise Thero.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
